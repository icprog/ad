(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mine/subPages/contact-us/contact-us"],{"2a65":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(n("a34a")),a=n("25d2");function s(t){return t&&t.__esModule?t:{default:t}}function c(t,e,n,o,a,s,c){try{var u=t[s](c),i=u.value}catch(r){return void n(r)}u.done?e(i):Promise.resolve(i).then(o,a)}function u(t){return function(){var e=this,n=arguments;return new Promise(function(o,a){var s=t.apply(e,n);function u(t){c(s,o,a,u,i,"next",t)}function i(t){c(s,o,a,u,i,"throw",t)}u(void 0)})}}var i={name:"",data:function(){return{text:"",id:"",user_id:"",list:[],page:1,sendInfo:{},receiveInfo:{}}},onLoad:function(e){this.id=e.id,this.user_id=t.getStorageSync("user_id"),this._getChatRecord(),this._getChatAvatar()},onShow:function(){this.$hideTabbarButton(),this._connect()},computed:{BASE_URL:function(){return a.BASE_URL},scrollHeight:function(){return t.getSystemInfoSync().windowHeight}},methods:{onSendMessageClick:function(){var e=this;if(""!=this.text){var n={send:this.user_id,receive:this.id,"data-text":this.text},o=JSON.stringify(n);console.log(o," at pages\\mine\\subPages\\contact-us\\contact-us.vue:64"),this.list.push({data:n,receiveInfo:this.receiveInfo,sendInfo:this.sendInfo}),this.text="",t.sendSocketMessage({data:o}),setTimeout(function(){e._onScrollTo()},1e3)}},_getChatRecord:function(){var e=u(o.default.mark(function e(){var n,s=this;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,a.getChatRecord)({token:t.getStorageSync("token"),other:this.id,page:this.page});case 2:n=e.sent,this.list=n.data,setTimeout(function(){s._onScrollTo()},1e3);case 5:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),_onScrollTo:function(){var e=t.createSelectorQuery().select(".wrap");e.boundingClientRect(function(e){console.log("得到布局位置信息"+JSON.stringify(e)," at pages\\mine\\subPages\\contact-us\\contact-us.vue:92"),t.pageScrollTo({scrollTop:e.height,duration:10})}).exec()},_getChatAvatar:function(){var e=u(o.default.mark(function e(){var n,s;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,a.getChatAvatar)({user_id:this.id});case 2:return n=e.sent,this.receiveInfo=n.data,t.setNavigationBarTitle({title:n.data.username}),e.next=7,(0,a.getChatAvatar)({user_id:this.user_id});case 7:s=e.sent,this.sendInfo=s.data;case 9:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),_connect:function(){var e=this;t.connectSocket({url:a.SOCKET_URL+"?id="+t.getStorageSync("user_id")}),t.onSocketOpen(function(t){console.log("WebSocket连接已打开！"," at pages\\mine\\subPages\\contact-us\\contact-us.vue:118")}),t.onSocketMessage(function(n){console.log("收到服务器内容："+n.data," at pages\\mine\\subPages\\contact-us\\contact-us.vue:121");var o=JSON.parse(n.data);console.log(e.receiveInfo," at pages\\mine\\subPages\\contact-us\\contact-us.vue:123"),console.log(e.sendInfo," at pages\\mine\\subPages\\contact-us\\contact-us.vue:124"),e.list.push({data:o,receiveInfo:e.sendInfo,sendInfo:e.receiveInfo}),t.vibrateLong({success:function(){console.log("success"," at pages\\mine\\subPages\\contact-us\\contact-us.vue:132")}})}),t.onSocketError(function(t){console.log("WebSocket连接打开失败，请检查！"," at pages\\mine\\subPages\\contact-us\\contact-us.vue:137")}),t.onSocketClose(function(t){console.log("WebSocket 已关闭！"," at pages\\mine\\subPages\\contact-us\\contact-us.vue:140"),e._connect()})}}};e.default=i}).call(this,n("6e42")["default"])},"5ea7":function(t,e,n){"use strict";var o=n("fd8b"),a=n.n(o);a.a},a05a:function(t,e,n){"use strict";n.r(e);var o=n("2a65"),a=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,function(){return o[t]})}(s);e["default"]=a.a},bb0b:function(t,e,n){"use strict";n.r(e);var o=n("e0a8"),a=n("a05a");for(var s in a)"default"!==s&&function(t){n.d(e,t,function(){return a[t]})}(s);n("5ea7");var c=n("2877"),u=Object(c["a"])(a["default"],o["a"],o["b"],!1,null,"245cc620",null);e["default"]=u.exports},e0a8:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement;t._self._c},a=[];n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a})},fd8b:function(t,e,n){}},[["9a4f","common/runtime","common/vendor"]]]);