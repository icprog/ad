(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/publish/subPages/edit-goods/edit-goods"],{"212a":function(t,e,n){"use strict";var i=n("29aa"),o=n.n(i);o.a},"29aa":function(t,e,n){},"814d":function(t,e,n){"use strict";n.r(e);var i=n("f683"),o=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);e["default"]=o.a},afcd:function(t,e,n){"use strict";n.r(e);var i=n("e57e"),o=n("814d");for(var s in o)"default"!==s&&function(t){n.d(e,t,function(){return o[t]})}(s);n("212a");var r=n("2877"),a=Object(r["a"])(o["default"],i["a"],i["b"],!1,null,"7b5597b4",null);e["default"]=a.exports},e57e:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o})},f683:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=u(n("a34a")),o=n("8a52"),s=n("c360"),r=n("25d2"),a=n("2f62");function u(t){return t&&t.__esModule?t:{default:t}}function c(t,e,n,i,o,s,r){try{var a=t[s](r),u=a.value}catch(c){return void n(c)}a.done?e(u):Promise.resolve(u).then(i,o)}function d(t){return function(){var e=this,n=arguments;return new Promise(function(i,o){var s=t.apply(e,n);function r(t){c(s,i,o,r,a,"next",t)}function a(t){c(s,i,o,r,a,"throw",t)}r(void 0)})}}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){l(t,e,n[e])})}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=function(){return n.e("components/upload").then(n.bind(null,"0318"))},p={name:"",data:function(){return{fixedTop:0,imgList1:[],imgList2:[],baseList1:[],baseList2:[],name:"",price:"",category:"请选择分类",sortId:"",num:"",desc:"",goodsId:""}},onBackPress:function(t){},onLoad:function(e){e&&(this.category=e.name,this.sortId=e.id),e.goodsId&&(this.goodsId=e.goodsId,this._reqGetGoodsDetail()),this.fixedTop=t.getSystemInfoSync().screenHeight-45-44-t.getSystemInfoSync().statusBarHeight+"px"},computed:h({},(0,a.mapState)(["sort_type","goods_detail","all_demand_type"]),{BASE_URL:function(){return r.BASE_URL}}),onShow:function(){this.$hideTabbarButton(),this.category=this.sort_type.name,this.sortId=this.sort_type.id},onHide:function(){this.SORT_TYPE({})},methods:h({},(0,a.mapActions)(["reqGetGoodsDetail"]),(0,a.mapMutations)(["SORT_TYPE"]),{onDelImg:function(t,e){this["imgList"+t].splice(e,1)},onAddImage:function(){var e=d(i.default.mark(function e(n){var s;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:s=this,t.chooseImage({count:1,success:function(){var e=d(i.default.mark(function e(a){return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:(0,o.pathToBase64)(a.tempFilePaths[0]).then(function(){var e=d(i.default.mark(function e(o){var a;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,r.uploadImage)({token:t.getStorageSync("token"),image:o});case 2:a=e.sent,s["imgList"+n].push(a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,this)}));function a(t){return e.apply(this,arguments)}return a}()});case 2:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}(),_reqGetGoodsDetail:function(){var e=d(i.default.mark(function e(){var n;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=this,e.next=3,this.reqGetGoodsDetail({token:t.getStorageSync("token"),cid:n.goodsId});case 3:this.goodsId&&this.all_demand_type.forEach(function(t,e){t.subclass.forEach(function(t,e){t.id==n.goods_detail.sort&&(n.category=t.name,console.log(n.category," at pages\\publish\\subPages\\edit-goods\\edit-goods.vue:130"))})}),this.imgList1=this.goods_detail.images,this.imgList2=this.goods_detail.dimages,this.name=this.goods_detail.title,this.price=this.goods_detail.price,this.num=this.goods_detail.count,this.sortId=this.goods_detail.sort,this.desc=this.goods_detail.described;case 11:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),onAddGoodsClick:function(){var e=d(i.default.mark(function e(){var n,o,s;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.imgList1.length<=0)){e.next=3;break}return t.showToast({title:"至少上传一张图片",icon:"none"}),e.abrupt("return");case 3:if(""!=this.name){e.next=6;break}return t.showToast({title:"请输入商品名称",icon:"none"}),e.abrupt("return");case 6:if(""!=this.num){e.next=9;break}return t.showToast({title:"请输入商品库存",icon:"none"}),e.abrupt("return");case 9:if(""!=this.category){e.next=12;break}return t.showToast({title:"请选择商品分类",icon:"none"}),e.abrupt("return");case 12:if(""!=this.desc){e.next=15;break}return t.showToast({title:"请输入商品介绍",icon:"none"}),e.abrupt("return");case 15:if(!(this.imgList2.length<=0)){e.next=18;break}return t.showToast({title:"至少上传一张详情图片",icon:"none"}),e.abrupt("return");case 18:if(n="",o="",s="",!this.goodsId){e.next=27;break}return n=this.imgList1.join(","),o=this.imgList2.join(","),e.next=26,(0,r.editGoods)({token:t.getStorageSync("token"),images:n,title:this.name,price:this.price,dimages:o,sort:this.sortId,stock:this.num,described:this.desc,commodity_id:this.goodsId});case 26:s=e.sent;case 27:2e3!=s.code&&200!=s.code||(t.showToast({title:"保存成功"}),setTimeout(function(){t.navigateBack()},1500));case 28:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),onChoseTypeClick:function(){t.navigateTo({url:"/pages/home/subPages/publish-type/publish-type?type=2"})},onAddImgEvent:function(t){1==t&&(0,s.uploadImg)(this.baseList1,this.imgList1),2==t&&(0,s.uploadImg)(this.baseList2,this.imgList2)},onDelImgEvent:function(t,e){1==t&&(0,s.delUploadImg)(this.baseList1,this.imgList1,e),2==t&&(0,s.delUploadImg)(this.baseList2,this.imgList2,e)}}),components:{upload:f}};e.default=p}).call(this,n("6e42")["default"])}},[["5cc6","common/runtime","common/vendor"]]]);